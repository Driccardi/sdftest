<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
<head>
    <!-- fonts  -->
    <link name="NotoSans" type="font" subtype="truetype"
          src="${nsfont.NotoSans_Regular}"
          src-bold="${nsfont.NotoSans_Bold}"
          src-italic="${nsfont.NotoSans_Italic}"
          src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2"/>

    <!--  locale-specific CJK fallbacks  -->
    <#if .locale == "zh_CN">
        <link name="NotoSansCJKsc" type="font" subtype="opentype"
              src="${nsfont.NotoSansCJKsc_Regular}"
              src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2"/>
    <#elseif .locale == "zh_TW">
        <link name="NotoSansCJKtc" type="font" subtype="opentype"
              src="${nsfont.NotoSansCJKtc_Regular}"
              src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2"/>
    <#elseif .locale == "ja_JP">
        <link name="NotoSansCJKjp" type="font" subtype="opentype"
              src="${nsfont.NotoSansCJKjp_Regular}"
              src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2"/>
    <#elseif .locale == "ko_KR">
        <link name="NotoSansCJKkr" type="font" subtype="opentype"
              src="${nsfont.NotoSansCJKkr_Regular}"
              src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2"/>
    <#elseif .locale == "th_TH">
        <link name="NotoSansThai" type="font" subtype="opentype"
              src="${nsfont.NotoSansThai_Regular}"
              src-bold="${nsfont.NotoSansThai_Bold}" bytes="2"/>
    </#if>

    <!--  macros  -->
    <macrolist>
        <!-- ===== header ===== -->
        <macro id="nlheader">
            <table style="width:100%;">
                <tr>
                    <td rowspan="3" style="vertical-align:top;">
                        <#if companyInformation.logoUrl?length != 0>
                            <@filecabinet nstype="image" style="float:left;margin:7px;height:50;" src="${companyInformation.logoUrl}" />
                        </#if>
                        <font color="#375E62"><span class="nameandaddress">${companyInformation.companyName}</span></font><br/>
                        <span class="nameandaddress">${companyInformation.addressText}</span>
                    </td>
                    <td align="right" style="font-size:26pt;color:#375E62;"><b>${record@title}</b></td>
                </tr>
                <tr><td align="right" style="font-size:14pt;">#${record.tranid}</td></tr>
                <tr><td align="right">${record.trandate}</td></tr>
            </table>
        </macro>

        <!-- ===== footer ===== -->
        <macro id="nlfooter">
            <table style="width:100%;border-top:0.25pt solid #375E62;">
                <tr>
                    <td>
                        <barcode codetype="code128" showtext="true" bar-width="0.75" value="${record.tranid}"/>
                    </td>
                    <td align="right"><pagenumber/> of <totalpages/></td>
                </tr>
                <tr>
                    <td colspan="2" style="background-color:#F7F5F2;padding:4px;font-size:7pt;color:#375E62;">
                        <b>Payment Guidance&nbsp;|&nbsp;</b>
                        Please remit payment within <b>30 days</b> of invoice date.<br/>
                        Bank Transfer:&nbsp;First National Bank&nbsp;&middot;&nbsp;Routing&nbsp;111000025&nbsp;&middot;&nbsp;Acct&nbsp;000123456&nbsp;&middot;&nbsp;Ref ${record.tranid}
                    </td>
                </tr>
            </table>
        </macro>
    </macrolist>

    <!--  styles  -->
    <style type="text/css">
        * {
            <#if .locale == "zh_CN">
                font-family:NotoSans,NotoSansCJKsc,sans-serif;
            <#elseif .locale == "zh_TW">
                font-family:NotoSans,NotoSansCJKtc,sans-serif;
            <#elseif .locale == "ja_JP">
                font-family:NotoSans,NotoSansCJKjp,sans-serif;
            <#elseif .locale == "ko_KR">
                font-family:NotoSans,NotoSansCJKkr,sans-serif;
            <#elseif .locale == "th_TH">
                font-family:NotoSans,NotoSansThai,sans-serif;
            <#else>
                font-family:NotoSans,sans-serif;
            </#if>
            font-size:9pt;
        }
        table { table-layout:fixed; }
        th {
            font-weight:bold;
            padding:6px 6px 4px;
            background-color:#375E62; /* Teal 140 */
            color:#ffffff;
        }
        td { padding:4px 6px; }
        table.header td { padding:0; font-size:10pt; }
        table.footer td { padding:0; font-size:8pt; }

        /* amount box */
        td.totalboxtop   { font-size:11pt;background-color:#F7F5F2;border:0.25pt solid #375E62; }
        td.totalboxmid   { font-size:26pt;background-color:#F7F5F2;border-left:0.25pt solid #375E62;border-right:0.25pt solid #375E62; }
        td.totalboxbot   { background-color:#F7F5F2;border:0.25pt solid #375E62;font-weight:bold; }

        tr.totalrow      { background-color:#434D69;color:#FFFFFF; } /* Lilac 140 */

        span.title  { font-size:28pt;color:#375E62; }
        span.number { font-size:16pt; }

        /* lighter horizontal rule */
        hr { width:100%;height:0;border-top:0.25pt solid #F7F5F2;color:#F7F5F2;background-color:#F7F5F2; }
    </style>
</head>

<body header="nlheader" header-height="10%" footer="nlfooter"
      footer-height="35pt" padding="0.5in 0.5in 0.5in 0.5in" size="Letter">

    <!--  Addresses & Total panel  -->
    <table style="width:100%;margin-top:10px;">
        <tr>
            <td class="addressheader" colspan="3"><b>${record.billaddress@label}</b></td>
            <td class="addressheader" colspan="3"><b>${record.shipaddress@label}</b></td>
            <td class="totalboxtop" colspan="5"><b>${record.total@label?upper_case}</b></td>
        </tr>
        <tr>
            <td class="address" colspan="3" rowspan="2">${record.billaddress}</td>
            <td class="address" colspan="3" rowspan="2">${record.shipaddress}</td>
            <td class="totalboxmid" align="right" colspan="5">${record.total}</td>
        </tr>
        <tr>
            <td class="totalboxbot" align="right" colspan="5">
                <b>${record.duedate@label}:</b>&nbsp;${record.duedate}
            </td>
        </tr>
    </table>

    <!--  body fields  -->
    <table class="body" style="width:100%;margin-top:10px;border-top:0.25pt solid #375E62;">
        <tr>
            <th>${record.terms@label}</th>
            <th>${record.duedate@label}</th>
            <th>${record.otherrefnum@label}</th>
            <th>${record.salesrep@label}</th>
            <th>${record.shipmethod@label}</th>
            <th>${record.partner@label}</th>
        </tr>
        <tr>
            <td>${record.terms}</td>
            <td>${record.duedate}</td>
            <td>${record.otherrefnum}</td>
            <td>${record.salesrep}</td>
            <td>${record.shipmethod}</td>
            <td>${record.partner}</td>
        </tr>
    </table>

    <!--  item list  -->
    <#if record.item?has_content>
        <table class="itemtable" style="width:100%;margin-top:10px;border-top:0.25pt solid #375E62;">
            <#list record.item as item>
                <#if item_index==0>
                    <thead>
                        <tr>
                            <th colspan="3" align="center">${item.quantity@label}</th>
                            <th colspan="12">${item.item@label}</th>
                            <th colspan="3">${item.options@label}</th>
                            <th colspan="4" align="right">${item.rate@label}</th>
                            <th colspan="4" align="right">${item.amount@label}</th>
                        </tr>
                    </thead>
                </#if>
                <tr>
                    <td colspan="3" align="center">${item.quantity}</td>
                    <td colspan="12"><span class="itemname"><b>${item.item}</b></span><br/>${item.description}</td>
                    <td colspan="3">${item.options}</td>
                    <td colspan="4" align="right">${item.rate}</td>
                    <td colspan="4" align="right">${item.amount}</td>
                </tr>
            </#list>
        </table>
        <hr/>
    </#if>

    <!--  totals  -->
    <table class="total" style="width:100%;margin-top:10px;">
        <tr>
            <td colspan="4"></td>
            <td align="right"><b>${record.subtotal@label}</b></td>
            <td align="right">${record.subtotal}</td>
        </tr>
        <tr>
            <td colspan="4"></td>
            <td align="right"><b>${record.taxtotal@label} (${record.taxrate}%)
            </b></td>
            <td align="right">${record.taxtotal}</td>
        </tr>
        <tr class="totalrow">
            <td colspan="4"></td>
            <td align="right"><b>${record.total@label}</b></td>
            <td align="right">${record.total}</td>
        </tr>
    </table>

</body>
</pdf>
