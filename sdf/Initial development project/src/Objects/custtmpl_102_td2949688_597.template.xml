<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
<head>
    <!-- Font Links -->
    <link name="NotoSans" type="font" subtype="truetype" src="${nsfont.NotoSans_Regular}" 
          src-bold="${nsfont.NotoSans_Bold}" src-italic="${nsfont.NotoSans_Italic}" 
          src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2" />
    <!-- Locale-specific Fonts -->
    <#if .locale == "zh_CN">
        <link name="NotoSansCJKsc" type="font" subtype="opentype" 
              src="${nsfont.NotoSansCJKsc_Regular}" src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2" />
    <#elseif .locale == "zh_TW">
        <link name="NotoSansCJKtc" type="font" subtype="opentype" 
              src="${nsfont.NotoSansCJKtc_Regular}" src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2" />
    <#elseif .locale == "ja_JP">
        <link name="NotoSansCJKjp" type="font" subtype="opentype" 
              src="${nsfont.NotoSansCJKjp_Regular}" src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2" />
    <#elseif .locale == "ko_KR">
        <link name="NotoSansCJKkr" type="font" subtype="opentype" 
              src="${nsfont.NotoSansCJKkr_Regular}" src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2" />
    <#elseif .locale == "th_TH">
        <link name="NotoSansThai" type="font" subtype="opentype" 
              src="${nsfont.NotoSansThai_Regular}" src-bold="${nsfont.NotoSansThai_Bold}" bytes="2" />
    </#if>

    <!-- Macros -->
    <macrolist>
        <macro id="nlheader">
            <table class="header" style="width: 100%; font-size: 10pt;">
                <tr>
                    <td rowspan="3">
                        <#if companyInformation.logoUrl?length != 0>
                            <@filecabinet nstype="image" style="float: left; margin: 7px" 
                                          src="${companyInformation.logoUrl}" />
                        </#if>
                        <span class="company-name">${companyInformation.companyName}</span><br />
                        <span class="company-address">${companyInformation.addressText}</span>
                    </td>
                    <td align="right"><span class="title">${record@title}</span></td>
                </tr>
                <tr>
                    <td align="right"><span class="number">#${record.tranid}</span></td>
                </tr>
                <tr>
                    <td align="right">${record.trandate}</td>
                </tr>
            </table>
        </macro>

        <macro id="nlfooter">
            <table class="footer">
                <tr>
                    <#if preferences.PRINT_BARCODES>
                        <td>
                            <barcode codetype="code128" showtext="true" value="${record.tranid}"/>
                        </td>
                    </#if>
                    <td align="right">
                        Page <pagenumber/> of <totalpages/>
                    </td>
                </tr>
            </table>
        </macro>
    </macrolist>

    <!-- Styles -->
    <style type="text/css">
        /* Global Styles */
        * {
            <#if .locale == "zh_CN">
                font-family: NotoSans, NotoSansCJKsc, sans-serif;
            <#elseif .locale == "zh_TW">
                font-family: NotoSans, NotoSansCJKtc, sans-serif;
            <#elseif .locale == "ja_JP">
                font-family: NotoSans, NotoSansCJKjp, sans-serif;
            <#elseif .locale == "ko_KR">
                font-family: NotoSans, NotoSansCJKkr, sans-serif;
            <#elseif .locale == "th_TH">
                font-family: NotoSans, NotoSansThai, sans-serif;
            <#else>
                font-family: NotoSans, sans-serif;
            </#if>
            color: #1D1D1D;
        }

        body {
            font-size: 9pt;
            background-color: #FFFFFF;
        }

        /* Header Styles */
        table.header {
            border-bottom: 2px solid #C1C1C1;
            margin-bottom: 20px;
        }

        .company-name {
            font-size: 12pt;
            font-weight: bold;
            color: #D9232E;
        }

        .company-address {
            font-size: 9pt;
            color: #5F5F5F;
        }

        .title {
            font-size: 24pt;
            font-weight: bold;
            color: #D9232E;
        }

        .number {
            font-size: 14pt;
            color: #5F5F5F;
        }
        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }


        th, td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #E0E0E0;
        }

        th {
            background-color: #F5F5F5;
            color: #1D1D1D;
            font-weight: bold;
        }

        /* Item Table Styles */
        table.itemtable th {
            background-color: #E8E8E8;
        }

        .itemname {
            font-weight: bold;
            color: #1D1D1D;
        }

        /* Footer Styles */
        table.footer {
            margin-top: 20px;
            border-top: 1px solid #C1C1C1;
            font-size: 8pt;
            color: #5F5F5F;
        }

        /* Terms  Conditions Styles */
        .terms-conditions {
            margin-top: 30px;
            font-size: 8pt;
            color: #5F5F5F;
        }

        .terms-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #D9232E;
        }

        /* Responsive Styles */
        @media print {
            body {
                margin: 0;
            }
        }
    </style>
</head>

<body header="nlheader" header-height="15%" footer="nlfooter" footer-height="20pt" 
      padding="0.5in 0.5in 0.5in 0.5in" size="Letter">

    <!-- Shipping Address -->
    <table>
        <tr>
            <td><strong>${salesorder.shipaddress@label}</strong></td>
        </tr>
        <tr>
            <td>${salesorder.shipaddress}</td>
        </tr>
    </table>

    <!-- Order Details -->
    <table>
        <tr>
            <th>${record.trandate@label}</th>
            <th>${salesorder.linkedtrackingnumbers@label}</th>
            <th>${record.shipmethod@label}</th>
            <th>${record.shipphone@label}</th>
        </tr>
        <tr>
            <td>${record.trandate}</td>
            <td>${salesorder.linkedtrackingnumbers}</td>
            <td>${record.shipmethod}</td>
            <td>${record.shipphone}</td>
        </tr>
    </table>

    <!-- Items Table -->
    <#if salesorder.item?has_content>
        <table class="itemtable">
            <thead>
                <tr>
                    <th>${salesorder.item[0].item@label}</th>
                    <th>${salesorder.item[0].description@label}</th>
                    <th>${salesorder.item[0].options@label}</th>
                    <th align="right">${salesorder.item[0].quantityordered@label}</th>
                    <th align="right">${salesorder.item[0].quantityremaining@label}</th>
                    <th align="right">${salesorder.item[0].quantity@label}</th>
                </tr>
            </thead>
            <tbody>
                <#list salesorder.item as tranline>
                    <tr>
                        <td><span class="itemname">${tranline.item}</span></td>
                        <td>${tranline.description}</td>
                        <td>${tranline.options}</td>
                        <td align="right">${tranline.quantityordered}</td>
                        <td align="right">${tranline.quantityremaining}</td>
                        <td align="right">${tranline.quantity}</td>
                    </tr>
                </#list>
            </tbody>
        </table>
    </#if>

    <!-- Terms  Conditions -->
    <div class="terms-conditions">
        <div class="terms-title">Terms &amp; Conditions</div>
        <table>
            <tr>
                <td>
                    Thank you for your business. Please note the following terms and conditions:
                    <ul>
                        <li>All sales are subject to our standard terms and conditions.</li>
                        <li>Goods once sold are not returnable unless previously agreed.</li>
                        <li>Payment is due within 30 days from the date of invoice.</li>
                        <li>Please inspect all goods upon receipt and report any discrepancies within 7 days.</li>
                    </ul>
                </td>
            </tr>
        </table>
    </div>

</body>
</pdf>
